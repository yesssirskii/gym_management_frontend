 <div class="page-container">
    <div class="page-header">
    <h2>{{ 'TRAINERS.Trainer_Details.Title' | translate }}</h2>
    <div class="header-actions">
        <p-button 
            *ngIf="canEdit"
            icon="pi pi-user-plus" 
            [label]="'TRAINERS.Trainer_Details.Add_Member' | translate"
            severity="info"
            (onClick)="showAddMember()"
            class="mr-2">
        </p-button>
        <p-button 
            icon="pi pi-arrow-left" 
            [label]="'COMMON.Back' | translate"
            severity="secondary"
            [outlined]="true"
            (onClick)="goBack()">
        </p-button>
    </div>
    </div>

    <div class="detail-grid" *ngIf="trainer">
        <p-card [header]="'TRAINERS.Trainer_Details.Personal_Info.Title' | translate" class="info-card">
            <div class="info-grid">
                <div class="info-item">
                    <label>{{ 'TRAINERS.Trainer_Details.Personal_Info.Name' | translate }}:</label>
                    <span>{{ trainer.firstName }} {{ trainer.lastName }}</span>
                </div>

                <div class="info-item">
                    <label>{{ 'TRAINERS.Trainer_Details.Personal_Info.Email' | translate }}:</label>
                    <span>{{ trainer.email }}</span>
                </div>

                <div class="info-item">
                    <label>{{ 'TRAINERS.Trainer_Details.Personal_Info.Phone' | translate }}:</label>
                    <span>{{ trainer.phoneNumber }}</span>
                </div>

                <div class="info-item">
                    <label>{{ 'TRAINERS.Trainer_Details.Personal_Info.Specialization' | translate }}:</label>
                    <span>{{ trainer.specialization }}</span>
                </div>

                <div class="info-item">
                    <label>{{ 'TRAINERS.Trainer_Details.Personal_Info.Experience' | translate }}:</label>
                    <span>{{ trainer.yearsOfExperience }} {{ 'TRAINERS.YEARS' | translate }}</span>
                </div>

                <div class="info-item">
                    <label>{{ 'TRAINERS.Trainer_Details.Personal_Info.Session_Rate' | translate }}:</label>
                    <span>{{ trainer.hourlyRate | currency:'EUR':'symbol':'1.2-2' }}</span>
                </div>

                <div class="info-item">
                    <label>{{ 'TRAINERS.Trainer_Details.Personal_Info.Rating' | translate }}:</label>
                    <span>{{ trainer.rating }}/5</span>
                </div>

                <div class="info-item">
                    <label>{{ 'TRAINERS.Trainer_Details.Personal_Info.Status' | translate }}:</label>
                    <p-tag 
                        [value]="trainer.isAvailable ? ('COMMON.AVAILABLE' | translate) : ('COMMON.UNAVAILABLE' | translate)"
                        [severity]="trainer.isAvailable ? 'success' : 'danger'">
                    </p-tag>
                </div>

                <div class="info-item full-width">
                    <label>{{ 'TRAINERS.Trainer_Details.Personal_Info.Bio' | translate }}:</label>
                    <p>{{ trainer.bio || 'N/A' }}</p>
                </div>
                
                <div class="info-item full-width">
                    <label>{{ 'TRAINERS.Trainer_Details.Personal_Info.Certifications' | translate }}:</label>
                    <p>{{ trainer.certifications || 'N/A' }}</p>
                </div>
            </div>
        </p-card>

        <p-card [header]="'TRAINERS.Trainer_Details.Assigned_Members.Title' | translate" class="members-card">
            <p-table 
                [value]="trainer.assignedMembers" 
                [paginator]="true" 
                [rows]="5"
                *ngIf="trainer.assignedMembers?.length > 0; else noMembers">
            
                <ng-template pTemplate="header">
                    <tr>
                        <th>{{ 'TRAINERS.Assigned_Members.Name' | translate }}</th>
                        <th>{{ 'TRAINERS.Assigned_Members.Membership_Number' | translate }}</th>
                        <th>{{ 'TRAINERS.Assigned_Members.Sessions_Per_Week' | translate }}</th>
                        <th>{{ 'TRAINERS.Assigned_Members.Session_Rate' | translate }}</th>
                        <th>{{ 'TRAINERS.Assigned_Members.Status' | translate }}</th>
                        <th *ngIf="canEdit">{{ 'TRAINERS.Assigned_Members.Actions' | translate }}</th>
                    </tr>
                </ng-template>
                
                <ng-template pTemplate="body" let-member>
                    <tr>
                        <td>{{ member.memberFirstName }} {{ member.memberLastName }}</td>
                        <td>{{ member.membershipNumber }}</td>
                        <td>{{ member.sessionsPerWeek }}</td>
                        <td>{{ member.sessionRate | currency:'EUR':'symbol':'1.2-2' }}</td>
                        <td>
                            <p-tag 
                                [value]="member.status"
                                [severity]="member.status === 'Active' ? 'success' : 'danger'">
                            </p-tag>
                        </td>
                        <td *ngIf="canEdit">
                            <p-button 
                                icon="pi pi-eye" 
                                [pTooltip]="'COMMON.VIEW_DETAILS' | translate"
                                severity="info"
                                size="small"
                                (onClick)="viewMember(member.memberId)"
                                class="mr-2">
                            </p-button>
                            <p-button 
                                icon="pi pi-trash" 
                                [pTooltip]="'TRAINERS.Assigned_Members.Remove' | translate"
                                severity="danger"
                                size="small"
                                (onClick)="removeMember(member)">
                            </p-button>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
            
            <ng-template #noMembers>
                <p>{{ 'TRAINERS.Trainer_Details.Assigned_Members.No_Members' | translate }}</p>
            </ng-template>
        </p-card>
    </div>

    <div class="loading-container" *ngIf="loading">
        <p-progressSpinner></p-progressSpinner>
    </div>
</div>

<app-assign-trainer-dialog 
    [(visible)]="addMemberDialogVisible"
    [selectedTrainer]="trainer"
    [mode]="'addMember'"
    (memberAdded)="onMemberAdded()">
</app-assign-trainer-dialog>
